## 目标与范围
- 对齐您PRD的双主题UI、前后端分离与JSON数据驱动，同时满足您提出的5种文案风格与质量规范。
- 在现有 Demo（AI_xhs_demo.html）的基础上，保留体验优势（主题切换、强反馈、复制）并补齐：后端组合算法、模板与数据文件、风格映射、双版本输出。

## 架构与技术栈（对齐PRD）
- 前端：Vue 3 + Vite + Tailwind CSS + Axios；保留 Demo 的交互设计与视觉语言（可先用Demo过渡）。
- 后端：Node.js（Express）；读写本地 `products.json` 与 `templates.json`，提供 REST API。
- 数据源：由 `正在销售的8大产品.txt` 首次解析生成 `products.json`；后续运营仅维护 `products.json` 与 `templates.json`。
- AI 接入：作为可选增强（与PRD V1.2一致），默认使用模板组合算法；若有API Key则可开启“AI润色”。

## 风格映射与补齐
- 必选风格（5）：
  - `story` → 故事向
  - `review` → 测评类
  - `dry_goods` → 干货分享
  - `education` → 教育科普
  - `friends` → 朋友圈推荐（新增按钮与模板）
- 可选扩展：`pain_point`（痛点向）与`showcase`（展示向）保留在PRD描述，但标记为“扩展风格”，不影响核心5类。

## 数据模型（JSON）
- products.json：
  - `{ id, name, summary, audience, sellingPoints[], resources[], stats{套数/级别/更新日期/...}, tagsDefault[] }`
- templates.json（按风格分类）：
  - `templates[style] = [ { titleTpl, bodyTpl, emojis[], tagPool[], rules{minEmoji, maxHashtags, titleLen}, placeholders[] } ]`
- 占位符（统一规范）：`{{name}} {{audience}} {{benefit}} {{evidence}} {{resourceCount}} {{levelCount}} {{updateDate}} {{tip}} {{gift}}`

## 文案生成算法（V1 模板组合）
- 信息抽取：从 `products.json` 读取产品要素；初次由解析器从 `.txt` 自动生成。
- 模板选择：按风格随机/加权选择模板；保证多样性与一致性（PRD“Creativity/Consistency”）。
- 标题生成：套用 `titleTpl` 并校验 12–20 字；若超限则智能截断并保留关键词。
- 标签生成：从 `tagsDefault` + `templates.tagPool` 组合，输出 3–5 个；避免重复与过长。
- 正文结构：强制“引入-主体-总结”；在引入和总结插入 emoji，密度≤每80字1个。
- 卖点植入：将 `sellingPoints` 均匀分布到主体段落（每段1–2条）；避免堆砌。
- 测评类数据：
  - 社恐测评：用 8维度雷达文字描述与区间语气（如“沟通紧张：中-偏高”），避免绝对承诺。
  - 题库/教材：统计项（套数/级别/含音频/答案）、更新日期与适用人群；建议性用语（如“更稳健地提升效率”）。
- 关键词融合：将用户输入关键词优先融入标题与首段；做同义替换增强自然度。
- 规则后处理：标题长度、emoji次数、标签数量、禁夸条款（去“百分百/绝对”），最终生成 `bodyPlain` 与 `bodyXHS` 两版。

## 后端接口
- `GET /api/products`：返回列表（id,name,tagsDefault）。
- `GET /api/templates`：返回可用风格与模板摘要。
- `POST /api/generate`：`{ productId, style, keywords[] }` → `{ title, tags[], bodyPlain, bodyXHS }`。
- `GET /api/health`：健康检查。

## 前端页面（对齐Demo + PRD）
- 左栏（控制台）：主题切换（记忆 localStorage），产品下拉，风格 Tag Pills（含“朋友圈推荐”），关键词输入（可选），主按钮（加载Pulse）。
- 右栏（生成区）：
  - 标题与正文两个 `<textarea>`（等宽字体、主题适配）。
  - 两版内容切换 tabs 或双卡片：`纯文本` 与 `XHS排版`。
  - `复制全部` 按钮（分别支持复制两版）。
- 体验细节：即时反馈、禁用状态、辉光、脉冲动画（沿用Demo的Tailwind配置）。

## XHS版排版规范（输出）
- 标题：置顶单行。
- 段落：`【引入】` `—` `【主体】`（点列） `—` `【总结】`（行动建议）。
- 标签：末行统一 `#` 前缀，3–5 个；避免超过12字。
- Emoji：≥2处，分布在引入与总结；不连续重复。

## 解析器（从 .txt → products.json）
- 规则：按“产品N：名称”分段；提取：名称/套数/级别/更新日期/资源类别/人群/赠品/关键词。
- 审核：生成后显示预览；运营可手动修订再保存为 `products.json`。

## 质量与测试
- 自动生成：每个产品5类文案，共40篇；前端“示例面板”集中展示。
- 校验器：
  - 标题长度（12–20），emoji数量（≥2），标签数（3–5）。
  - 文风检查：禁夸张词；卖点均匀分布。
- 人工审核清单：自然度、可信度、有用度（3分项）；备注收集。
- 反馈闭环：后端记录生成参数与评分，定期调整模板权重与词库。

## 里程碑
- M1：解析器与 `products.json` 初稿（含8产品）；`templates.json` 5风格模板（1–2天）。
- M2：后端API与组合算法；`/api/generate` 对齐规则（1–2天）。
- M3：前端接入API，补齐“朋友圈推荐”、双版本输出与复制（1天）。
- M4：样本文案与审核面板；反馈收集（1天）。
- M5：可选AI润色（按PRD V1.2），提供开关与降级策略（持续）。

## 验收标准
- 控制台与生成区完整交互；40篇样本合规；输出双版本；复制功能稳定。
- 仅通过 `products.json` 与 `templates.json` 可维护；无API Key仍可生成（模板模式）。
- 风格与规则完全符合您的原始要求与PRD。